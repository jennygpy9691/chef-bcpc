###############################################################################
#                           generated by chef
###############################################################################

# setuid    user to run daemon
#
setuid = pdns

# setgid    group to run daemon
#
setgid = pdns

# local-address Local IP address to which we bind
#
local-address = <%= node['bcpc']['powerdns']['local_address'] %>

# local-port    The port on which we listen
#
local-port = <%= node['bcpc']['powerdns']['local_port'] %>

# master    Act as a master
#
master = yes

# slave    Act as a slave
#
slave = no

# guardian  Run within a guardian process
#
guardian = yes

# allow-axfr-ips    If enabled, restrict zonetransfers to originate from these
#                   IP addresses
#
<% if node['bcpc']['powerdns']['axfr']['enabled'] %>
<% ips = node['bcpc']['powerdns']['axfr']['ips'].dup %>
<% ips.unshift(node['bcpc']['powerdns']['local_address']) %>
disable-axfr = no
allow-axfr-ips = <%= ips.join(',') %>
<% else %>
disable-axfr = yes
<% end %>

# MySQL Configuration
#
# Launch gmysql backend
launch = gmysql

# gmysql parameters
gmysql-host = <%= node['service_ip'] %>
gmysql-port = 3306
gmysql-dbname = <%= @db['dbname'] %>
gmysql-user = <%= @db['username'] %>
gmysql-password = <%= @db['password'] %>

# receiver-threads  Number of receiver threads to launch
#
receiver-threads = <%= node['bcpc']['powerdns']['receiver_threads'] %>

# webserver Start a webserver for monitoring
#
webserver = yes

# webserver-address    Address webserver to listen on
#
webserver-address = <%= node['bcpc']['powerdns']['webserver']['address'] %>

# webserver-port    Port of webserver to listen on
#
webserver-port = <%= node['bcpc']['powerdns']['webserver']['port'] %>

# webserver-password    Password required for accessing the webserver
#
webserver-password = <%= @webserver_password %>

# api		enable http rest api
#
api = yes

# api-key		api key needed to access the api
#
api-key = <%= @api_key %>

# security-poll-suffix Domain name from which to query security update
# notifications. Setting this to an empty string disables secpoll.
#
security-poll-suffix = <%= node['bcpc']['powerdns']['security_poll_suffix'] %>

<% if node['bcpc']['powerdns']['also-notify']['enabled'] %>
# also-notify   When notifying a domain, also notify these nameservers
only-notify =
also-notify = <%= node['bcpc']['powerdns']['also-notify']['ips'].join(',') %>
<% end %>
